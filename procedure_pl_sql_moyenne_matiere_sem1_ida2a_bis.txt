
DECLARE
	v_nCount integer;

BEGIN

	------------------
	-- 1er SEMESTRE
	------------------

	-- ALGORITHME

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_ALGO_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_ALGO_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_ALGO_SEM1_IDA2A';

	END IF;

	-- ANALYSE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_ANALYSE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_ANALYSE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_ANALYSE_SEM1_IDA2A';

	END IF;

	-- ANGLAIS

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_ANGLAIS_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_ANGLAIS_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';
		
	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_ANGLAIS_SEM1_IDA2A';

	END IF;

	-- ASSIDUTE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_ASSIDUTE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_ASSIDUTE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';
		
	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_ASSIDUTE_SEM1_IDA2A';

	END IF;

	-- BASE DE DONNEES

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_BD_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_BD_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_BD_SEM1_IDA2A';

	END IF;

	-- LANGAGE C

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_C_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_C_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_C_SEM1_IDA2A';

	END IF;

	-- COMPTABILITE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_COMPTA_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_COMPTA_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_COMPTA_SEM1_IDA2A';

	END IF;

	-- CONDUITE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_CONDUITE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_CONDUITE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_CONDUITE_SEM1_IDA2A';

	END IF;

	-- DROIT

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_DROIT_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_DROIT_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_DROIT_SEM1_IDA2A';
		
	END IF;

	-- ECONOMIE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_ECONOMIE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_ECONOMIE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_ECONOMIE_SEM1_IDA2A';

	END IF;

	-- FRANCAIS

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_FRANCAIS_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_FRANCAIS_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_FRANCAIS_SEM1_IDA2A';

	END IF;

	-- MATHEMATIQUE FINANCIERE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_MATH_FIN_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_MATH_FIN_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_MATH_FIN_SEM1_IDA2A';

	END IF;

	-- MATHEMATIQUE GENERALE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_MATH_GENE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_MATH_GENE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_MATH_GENE_SEM1_IDA2A';

	END IF;

	-- NEGOCIATION INFORMATIQUE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_NEGO_INFO_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_NEGO_INFO_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_NEGO_INFO_SEM1_IDA2A';

	END IF;

	-- LANGAGE PHP

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_PHP_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_PHP_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';
	
	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_PHP_SEM1_IDA2A';

	END IF;

	-- PROJET

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_PROJET_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_PROJET_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_PROJET_SEM1_IDA2A';

	END IF;

	-- SYSTEME D'EXPLOITATION

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_SE_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_SE_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_SE_SEM1_IDA2A';

	END IF;

	-- TELEINFORMATIQUE

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_TELEINFO_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_TELEINFO_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';
	
	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_TELEINFO_SEM1_IDA2A';

	END IF;

	-- VISUAL BASIC

	SELECT count(table_name) into v_nCount 
	FROM user_tables 
	WHERE table_name = 'MOYENNE_VB_SEM1_IDA2A';

	IF(v_nCount=0) THEN 

		EXECUTE IMMEDIATE 'CREATE TABLE MOYENNE_VB_SEM1_IDA2A AS SELECT * FROM MOYENNE_MATIERE';

	ELSE
		EXECUTE IMMEDIATE 'DELETE FROM MOYENNE_VB_SEM1_IDA2A';

	END IF;

	-- Appel de la procédure cataloguée pl/sql moyenne_session
	PRC_MOYENNE_SESSION();
	-- Appel de la procédure cataloguée pl/sql points_généraux
	PRC_TOTAL_POINT();
	-- Appel de la procédure cataloguée moyenne_matiere_ida2a_sem1
	GESTIONRELEVEIDA2A.PRC_MOY_MATIERE_IDA2A_SEM1();
	
    -- ROLLBACK;
	COMMIT; -- validation des changements apportés par la transaction

END;
/
